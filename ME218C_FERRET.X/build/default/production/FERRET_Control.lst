MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;==========================================================================
                      00002 ;FERRET Controller - 218C Project Infrastructure - Spring '17
                      00003 ;History:
                      00004 ;Author -   Date -      Notes -
                      00005 ;LW         05/28/17    Added second servo and refined sequencing
                      00006 ;LW         05/12/17    Core functionality tested and debugged with hardware
                      00007 ;LW         05/11/17    Implemented remainder of requirements & added
                      00008 ;                           mpasm relocatable code directives
                      00009 ;LW         05/09/17    Implemented timers, run button, heartbeat LED,
                      00010 ;                           and lift fan control
                      00011 ;LW         04/28/17    Revised template for PWM on CCP (Timer2)
                      00012 ;LW         04/20/17    Initial copy of old template code  
                      00013 ;==========================================================================
                      00014 
                      00015 ;==========================================================================
                      00016 ;Defines, PIC configuration, and code organization
                      00017 ;==========================================================================
                      00018 
                      00019 ;PIC configuration
                      00020     list P=PIC16F690
                      00021 #include "P16F690.inc"
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ; Build date : May 15 2016
                      00005 ;  MPASM PIC16F690 processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2016 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      00757         LIST
2007   3FC4           00022     __config(_CP_OFF & _WDT_OFF & _PWRTE_ON & _MCLRE_OFF & _INTOSCIO)
                      00023     
                      00024 ;Pin mapping
                      00025 #define HB_LED      RA0         ;Heartbeat LED to show PIC activity
                      00026 #define RUN_IND     RA1         ;LED to indicate RUNNING status
                      00027 #define RUN_BTN     RA2         ;Button to start a run routine
                      00028 #define SRVB_CNTRL  RC1         ;Servo B (Right) control signal output
                      00029 #define SRVA_CNTRL  RC2         ;Servo A (Left) control signal output
                      00030 #define TF_DIR      RC4         ;Thrust fan direction output pin
                      00031 #define TF_PWM      RC5         ;Thrust fan PWM output pin
                      00032 #define LIFT_CNTRL  RC6         ;Lift fan control pin
                      00033 
                      00034 ;Timer 0 defines (Servo timing values)
                      00035 #define TWENTY_MS   H'4E'       ;time = hex value * 0.256ms
                      00036 #define SRVA_ENG    H'08'       ;Pulse width ~ 2ms
                      00037 #define SRVA_DIS    H'06'       ;Pulse width ~ 1.5ms
                      00038 #define SRVB_ENG    H'08'       ;Pulse width ~ 1.5ms
                      00039 #define SRVB_DIS    H'06'       ;Pulse width ~ 2ms
                      00040 
                      00041 ;Timer 1 defines (Approximate time values)
                      00042 #define HALF_S      H'0F'       ;time = hex value * 32.8ms
                      00043 #define ONE_S       H'1E'
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00044 #define TWO_S       H'3D'           
                      00045 #define THREE_S     H'5C'           
                      00046 #define FOUR_S      H'7A'           
                      00047 #define FIVE_S      H'99'           
                      00048 #define SIX_S       H'B7'
                      00049 #define SEVEN_S     H'D6'
                      00050 #define EIGHT_S     H'F4'
                      00051 #define HB_TIME     HALF_S
                      00052 #define DEB_TIME    FIVE_S
                      00053     
                      00054 ;Timer 2 defines (Thrust fan PWM configurations)
                      00055 #define TF_PERIOD   H'65'       ;Period for thrust fan PWM (PR2 value)
                      00056 #define TF_FULL     TF_PERIOD   ;100% duty cycle on thrust fan
                      00057 #define TF_HALF     H'32'       ;50% duty cycle on thrust fan
                      00058 #define TF_OFF      H'00'       ;0% duty cycle
                      00059 
                      00060 ;Flag defines
                      00061 #define RUNNING     0           ;flag to note if FERRET is in RUNNING state
                      00062 #define DEBOUNCING  1           ;flag to note if FERRET is in DEBOUNCING state
                      00063 #define SRVA_ENGD   2           ;flag to note if servo A is ENGAGED
                      00064 #define SRVB_ENGD   3           ;flag to note if servo B is ENGAGED
                      00065     
                      00066 ;Misc. & readability defines
                      00067 #define HB_ON       H'01'       ;bit value in PORTA to turn the HB LED on
                      00068 #define NUM_CYCLS   H'FF'       ;number of RUN cycles to repeat per routine
                      00069 #define NUM_STEPS   H'02'       ;number of steps per RUN cycle - 1
                      00070     
                      00071 ;Variable assignment (stored in common access bank registers)
                      00072 .vars   udata_shr   H'70'
                      00073 ; Temporary register storage for ISR
0070                  00074 W_TEMP      res 1   ;temporary storage for W register
0071                  00075 STATUS_TEMP res 1   ;temporary storage for STATUS register
0072                  00076 PCLATH_TEMP res 1   ;temporary storage for PCLATH register
                      00077 ; Software counters/timers
0073                  00078 CYCL_CNT    res 1   ;RUN sequence cycle counter
0074                  00079 SRV_CNT     res 1   ;servo tick counter
0075                  00080 SRVA_PW     res 1   ;servo A control signal PW counter
0076                  00081 SRVB_PW     res 1   ;servo B control signal PW counter
0077                  00082 SRV_TMR     res 1   ;general servo control signal timer
0078                  00083 RUN_TMR     res 1   ;RUN step timer
0079                  00084 HB_TMR      res 1   ;heartbeat blink timer
007A                  00085 DEB_TMR     res 1   ;button debounce timer
                      00086 ; Misc. vars
007B                  00087 FLAGS       res 1   ;register to hold various boolean flags
007C                  00088 RUN_INDX    res 1   ;RUN sequence index
                      00089 ;End of variable assignment
                      00090 
                      00091 ;Reset vector code organization
                      00092 .reset  code    H'00'       ;unconditional branch to MAIN at (0) memory location
0000   2???           00093         goto    MAIN_SETUP  ;
                      00094 
                      00095 ;Interrupt vector code organization
                      00096 .ivect  code    H'04'       ;unconditional branch to ISR at (4) memory location
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0004   2???           00097         goto    ISR_PUSH    ;
                      00098 
                      00099 ;Lookup table code organization
                      00100 .tables code    H'05'       ;start lookup tables immediately following int. vec.
                      00101         
                      00102 ;==========================================================================
                      00103 ;RUN_STEP_SEQ lookup table - hardcoded routine steps
                      00104 ;==========================================================================
0005                  00105 RUN_STEP_SEQ:                       ;
0005   0782           00106         addwf   PCL,F               ;
0006   2???           00107         goto    RUN_DRIFT           ;1st
0007   2???           00108         goto    RUN_FULL_FWD        ;2
0008   2???           00109         goto    RUN_DRIFT           ;3
                      00110 
                      00111 ;==========================================================================
                      00112 ;RUN_STEP_TIME lookup table - hardcoded routine times for each step
                      00113 ;==========================================================================
0009                  00114 RUN_STEP_TIME:              ;
0009   0782           00115         addwf   PCL,F       ;
000A   3499           00116         retlw   FIVE_S      ;1st
000B   3499           00117         retlw   FIVE_S      ;2
000C   34F4           00118         retlw   EIGHT_S     ;3
                      00119         ;total time should be ~44 seconds (x5 cycles)
                      00120         
                      00121 ;==========================================================================
                      00122 ;MAIN setup code
                      00123 ;==========================================================================
                      00124 .main   code                    ;begin main body code
                      00125         
0000                  00126 MAIN_SETUP:                     ;
                      00127         ;Clock configuration
0000   1683 1303      00128         banksel OSCCON          ;configure for 8MHz internal osc speed
0002   3070           00129         movlw   B'01110000'     ;
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0003   008F           00130         movwf   OSCCON          ;
0004                  00131 WAIT_4_CLOCK:                   ;wait for stable clock
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0004   1D0F           00132         btfss   OSCCON,HTS      ;
0005   2???           00133         goto    WAIT_4_CLOCK    ;
                      00134 
                      00135         ;Pin configuration (Port A & C Basic Preparation)
                      00136         ; Port Clearing
0006   1283 1303      00137         banksel PORTA           ;clear port A (PORTA register)
0008   0185           00138         clrf    PORTA           ;
0009   1283 1303      00139         banksel PORTC           ;clear port C (PORTC register)
000B   0187           00140         clrf    PORTC           ;
                      00141         ; Mode Configuration
000C   1283 1703      00142         banksel ANSEL           ;set all I/O pins as digital (ANSEL(H) register)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000E   019E           00143         clrf    ANSEL           ;
000F   1283 1703      00144         banksel ANSELH          ;
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0011   019F           00145         clrf    ANSELH          ;
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00146         ; Direction Configuration
0012   1683 1303      00147         banksel TRISA           ;set all A pins as outputs (TRISA register)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0014   0185           00148         clrf    TRISA           ;and set the Run button pin to an input
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0015   1505           00149         bsf     TRISA,RUN_BTN   ;
0016   1683 1303      00150         banksel TRISC           ;set all C pins as outputs (TRISC register)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0018   0187           00151         clrf    TRISC           ;
                      00152         
                      00153         ;Run Button IOC configuration
0019   1283 1303      00154         banksel INTCON          ;enable IOC in control register
001B   100B           00155         bcf     INTCON,RABIF    ; - clear flag
001C   158B           00156         bsf     INTCON,RABIE    ; - enable interrupt
001D   1683 1303      00157         banksel IOCA            ;locally enable IOC for run button
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
001F   1516           00158         bsf     IOCA,RUN_BTN    ;
                      00159         
                      00160         ;Timer 0 counter configuration (multi-servo control)
0020   1683 1303      00161         banksel OPTION_REG      ;
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0022   1281           00162         bcf     OPTION_REG,T0CS ;set clock source as FOSC/4 (TOCS in OPTION_REG)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0023   1181           00163         bcf     OPTION_REG,PSA  ;assign prescaler to Timer 0
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0024   1001           00164         bcf     OPTION_REG,PS0  ;set min. prescale value (PS<2:0> in OPTION_REG)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0025   1081           00165         bcf     OPTION_REG,PS1  ; -> (Prescale) * (256 * 4) / FOSC = Period
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0026   1101           00166         bcf     OPTION_REG,PS2  ; -> (2) * (256 * 4) / FOSC = 0.256ms
0027   1283 1303      00167         banksel INTCON          ;
0029   110B           00168         bcf     INTCON,T0IF     ;clear any existing Timer 0 interrupt flags
002A   168B           00169         bsf     INTCON,T0IE     ;enable Timer 0 overflow interrupt
                      00170         
                      00171         ;Timer 1 configuration (heartbeat & random timers)
002B   1283 1303      00172         banksel T1CON           ;set clock source to FOSC/4 (TMR1CS in T1CON)
002D   1090           00173         bcf     T1CON,TMR1CS    ;
002E   1210           00174         bcf     T1CON,T1CKPS0   ;set prescale to 1:1 (T1CKPS<1:0> in T1CON
002F   1290           00175         bcf     T1CON,T1CKPS1   ;
0030   1283 1303      00176         banksel PIR1            ;enable rollover interrupt:
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0032   100C           00177         bcf     PIE1,TMR1IF     ; - clear interrupt flag (TMR1IF in PIR1)
0033   1683 1303      00178         banksel PIE1            ; - local enable (TMR1IE in PIE1)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0035   140C           00179         bsf     PIE1,TMR1IE     ;
0036   1283 1303      00180         banksel INTCON          ; - peripheral enable (PEIE in INTCON)
0038   170B           00181         bsf     INTCON,PEIE     ;
0039   1283 1303      00182         banksel T1CON           ;turn on the timer (TMR1ON in T1CON)
003B   1410           00183         bsf     T1CON,TMR1ON    ;
                      00184         
                      00185         ;PWM configuration (Thrust Fan Control):
                      00186         ;   Using Method from Datasheet:
                      00187         ;       1. Disable PWM pin (CCP1) by setting associated TRIS bit
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00188         ;       2. Set PWM period by loading PR2 register
                      00189         ;       3. Configure CCP module for PWM by loading CCP1CON
                      00190         ;       4. Set duty cycle by loading CCPR1L & DC1B<1:0> of CCP1CON
                      00191         ;       5. Configure and start Timer2
                      00192         ;           a. Clear TMR2IF interrupt flag in PIR1
                      00193         ;           b. Set Timer2 prescale value by loading T2CKPS in T2CON
                      00194         ;           c. Enable Timer2 by setting TMR2ON in T2CON
                      00195         ;       6. Enable PWM ouput
                      00196         ;           a. Wait until Timer2 overflows (TMR2IF interrupt flag)
                      00197         ;           b. Enable CCP1 pin by clearing associated TRIS bit
                      00198         
                      00199         ;   Example Calculations:
                      00200         ;   PWM Period = [(PR2)+1]*(4/FOSC)*TMR2PreScale
                      00201         ;       -> PR2 = [PWM Period]*FOSC/(4*TMR2PreScale)-1
                      00202         ;       ->     = [1/5kHz]*8MHz/(4*4)-1 = 99 (0x63)
                      00203         ;   Duty Cycle = (CCPR1L:CCP1CON<5:4>)/[4*(PR2+1)]
                      00204         ;       -> CCPR1L:CCP1CON<5:4> = [Duty Cycle]*[4*(PR2+1)]
                      00205         ;       ->                     = [0.5]*[4*99+1] = 50 (0x32)
                      00206         
003C   1683 1303      00207         banksel TRISC           ; Step 1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
003E   1687           00208         bsf     TRISC,TF_PWM    ;
003F   1683 1303      00209         banksel PR2             ; Step 2
0041   3065           00210         movlw   TF_PERIOD       ;
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0042   0092           00211         movwf   PR2             ;
0043   1283 1303      00212         banksel CCP1CON         ; Step 3
0045   300C           00213         movlw   B'00001100'     ; *include 2 LSBs of duty cycle here (00)*
0046   0097           00214         movwf   CCP1CON         ;
0047   2???           00215         call    TF_SET_OFF      ; Step 4
0048   1283 1303      00216         banksel PIR1            ; Step 5a
004A   108C           00217         bcf     PIR1,TMR2IF     ;
004B   1283 1303      00218         banksel T2CON           ; Step 5b
004D   3001           00219         movlw   B'00000001'     ;
004E   0092           00220         movwf   T2CON           ;
004F   1512           00221         bsf     T2CON,TMR2ON    ; Step 5c
0050   1283 1303      00222         banksel PIR1            ; Step 6a
0052                  00223 WAIT_4_CYCLE:                   ;
0052   1C8C           00224         btfss   PIR1,TMR2IF     ;
0053   2???           00225         goto    WAIT_4_CYCLE    ;
0054   1683 1303      00226         banksel TRISC           ; Step 6b
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0056   1287           00227         bcf     TRISC,TF_PWM    ;
                      00228         
                      00229         ;ADC configuration (Thrust Fan Speed Adjust);
                      00230         ;   Using Method from Datasheet:
                      00231         ;       1. Configure the analog input pin
                      00232         ;           a. Set the associated ANSEL bit
                      00233         ;           b. Set the associated TRIS bit
                      00234         ;       2. Set the appropriate input channel (CHS bit in ADCON0)
                      00235         ;       .......etc
                      00236         ; ********TODO********
                      00237         
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00238         ;Init software timer/counter values
0057   2???           00239         call    INIT_VARS       ;
                      00240         
                      00241         ;Enable global interrupts
0058   178B           00242         bsf     INTCON,GIE      ;
                      00243         
0059   2???           00244         goto    MAIN_LOOP       ;once setup complete, go to the run LOOP
                      00245 
                      00246 ;==========================================================================
                      00247 ;MAIN run code LOOP
                      00248 ;==========================================================================
005A                  00249 MAIN_LOOP:                      ;
005A   0000           00250         nop                     ;put any run code here (i.e. event checkers)    
005B   2???           00251         goto    MAIN_LOOP       ;return to start of run LOOP
                      00252 
                      00253 ;==========================================================================
                      00254 ;INIT_VARS routine code
                      00255 ;==========================================================================
005C                  00256 INIT_VARS:                      ;
005C   300F           00257         movlw   HB_TIME         ;load heartbeat blink time
005D   00??           00258         movwf   HB_TMR          ;
005E   01??           00259         clrf    FLAGS           ;clear all program flags
005F   2???           00260         goto    RUN_OFF         ;disable all motors (turn FERRET OFF)
                      00261         
                      00262 ;==========================================================================
                      00263 ;ISR routine code
                      00264 ;==========================================================================
0060                  00265 ISR_PUSH:                           ;
0060   00??           00266         movwf   W_TEMP              ;start by storing W, STATUS, and PCLATH
0061   0E03           00267         swapf   STATUS,W            ;  in TEMP registers
0062   00??           00268         movwf   STATUS_TEMP         ;
0063   080A           00269         movf    PCLATH,W            ;
0064   00??           00270         movwf   PCLATH_TEMP         ;
                      00271         
0065                  00272 ISR_IOCA:                           ;
0065   1283 1303      00273         banksel INTCON              ;check if IOC fired on port A
0067   180B           00274         btfsc   INTCON,RABIF        ; if the RUN button interrupt flag is high
0068   2???           00275         call    IOC_RESP            ; call IOC response routine
                      00276         
0069                  00277 ISR_T0:                             ;
0069   1283 1303      00278         banksel INTCON              ;check Timer 0 interrupt
006B   1E8B           00279         btfss   INTCON,T0IE         ; check local interrupt enable status
006C   2???           00280         goto    ISR_T1              ;  if clear, skip to next section of ISR
006D   190B           00281         btfsc   INTCON,T0IF         ;  else, check interrupt flag status
006E   2???           00282         call    TMR0_OVFL           ;    if set, call the Timer 0 ovrflw routine
                      00283 
006F                  00284 ISR_T1:                             ;
006F   1683 1303      00285         banksel PIE1                ;check Timer 1 interrupt
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0071   1C0C           00286         btfss   PIE1,TMR1IE         ; check local interrupt enable status
0072   2???           00287         goto    ISR_POP             ;  if clear, skip to next section of ISR
0073   1283 1303      00288         banksel PIR1                ;
0075   180C           00289         btfsc   PIR1,TMR1IF         ; check interrupt flag status
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0076   2???           00290         call    TMR1_OVFL           ;  if set, call the Timer 0 overflow routine
                      00291 
0077                  00292 ISR_POP:
0077   08??           00293         movf    PCLATH_TEMP,W       ;finish by pulling back the original W,
0078   008A           00294         movwf   PCLATH              ; STATUS, and PCLATH from the TEMP registers
0079   0E??           00295         swapf   STATUS_TEMP,W       ;
007A   0083           00296         movwf   STATUS              ;
007B   0E??           00297         swapf   W_TEMP,F            ;
007C   0E??           00298         swapf   W_TEMP,W            ;
007D   0009           00299         retfie                      ;return from the ISR
                      00300         
                      00301 ;==========================================================================
                      00302 ;IOC_RESP routine code
                      00303 ;==========================================================================
007E                  00304 IOC_RESP:                           ;
007E   2???           00305         call    DEBOUNCE_START      ;start the extended debouncing routine
007F   1C00           00306         btfss   FLAGS,RUNNING       ;if not currently RUNNING,
0080   2???           00307         goto    START_CHASE         ; start the chase sequence
0081   2???           00308         goto    END_CHASE           ;else, end the chase sequence
                      00309         
                      00310 ;==========================================================================
                      00311 ;DEBOUNCE_START routine code
                      00312 ;==========================================================================
0082                  00313 DEBOUNCE_START:                     ;
0082   1283 1303      00314         banksel PORTA               ;sample Port A (clears mismatch condition)
0084   0805           00315         movf    PORTA,W             ;
0085   1683 1303      00316         banksel IOCA                ;locally disable IOC for run button
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0087   1116           00317         bcf     IOCA,RUN_BTN        ;
0088   1283 1303      00318         banksel INTCON              ;clear INTCON IOC flag
008A   100B           00319         bcf     INTCON,RABIF        ;
008B   1480           00320         bsf     FLAGS,DEBOUNCING    ;set debouncing flag
008C   3099           00321         movlw   DEB_TIME            ;load debounce time into timer register
008D   00??           00322         movwf   DEB_TMR             ;
008E   0008           00323         return                      ;
                      00324         
                      00325 ;==========================================================================
                      00326 ;DEBOUNCE_END routine code
                      00327 ;==========================================================================
008F                  00328 DEBOUNCE_END:                       ;
008F   1080           00329         bcf     FLAGS,DEBOUNCING    ;clear debouncing flag
0090   1283 1303      00330         banksel INTCON              ;
0092   100B           00331         bcf     INTCON,RABIF        ;clear IOC flag in INTCON
0093   1683 1303      00332         banksel IOCA                ;locally enable IOC for run button
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0095   1516           00333         bsf     IOCA,RUN_BTN        ;
0096   0008           00334         return                      ;
                      00335         
                      00336 ;==========================================================================
                      00337 ;START_CHASE branch code
                      00338 ;==========================================================================
0097                  00339 START_CHASE:                        ;
0097   1283 1303      00340         banksel INTCON              ;clear the port A IOC flag
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0099   100B           00341         bcf     INTCON,RABIF        ;
009A   1400           00342         bsf     FLAGS,RUNNING       ;change RUNNING state to true
009B   1283 1303      00343         banksel PORTA               ;enable RUNNING indicator LED
009D   1485           00344         bsf     PORTA,RUN_IND       ;
009E   01??           00345         clrf    RUN_INDX            ;reset RUN sequence index
009F   30FF           00346         movlw   NUM_CYCLS           ;reset cycle count
00A0   00??           00347         movwf   CYCL_CNT            ;
00A1   2???           00348         call    RUN_CNTRL           ;run first step
00A2   0008           00349         return                      ;return from the subroutine
                      00350         
                      00351 ;==========================================================================
                      00352 ;END_CHASE branch code
                      00353 ;==========================================================================
00A3                  00354 END_CHASE:                          ;
00A3   1000           00355         bcf     FLAGS,RUNNING       ;change RUNNING state to false
00A4   1283 1303      00356         banksel PORTA               ;disable RUNNING indicator
00A6   1085           00357         bcf     PORTA,RUN_IND       ;
00A7   2???           00358         goto    RUN_OFF             ;disable all motors (turn FERRET OFF)
                      00359 
                      00360 ;==========================================================================
                      00361 ;TMR0_OVFL routine code (servo PWM)
                      00362 ;==========================================================================
00A8                  00363 TMR0_OVFL:                          ;
00A8   1283 1303      00364         banksel INTCON              ;clear Timer 0 interrupt flag
00AA   110B           00365         bcf     INTCON,T0IF         ;
                      00366         
                      00367         ;Servo control output timing
00AB   03??           00368         decf    SRV_CNT,W           ;decrement the counter
00AC   1903           00369         btfsc   STATUS,Z            ;if zero,
00AD   304E           00370         movlw   TWENTY_MS           ; load 20 ms back into counter
00AE   00??           00371         movwf   SRV_CNT             ;
                      00372         
                      00373         ;Servo A
00AF   1283 1303      00374         banksel PORTC               ;check if SRV_CNT is above SRVA_PW
00B1   02??           00375         subwf   SRVA_PW,W           ;
00B2   1C03           00376         btfss   STATUS,C            ; if above, clear SRV_CNTRL pin
00B3   1107           00377         bcf     PORTC,SRVA_CNTRL    ;
00B4   1803           00378         btfsc   STATUS,C            ; else, set SRV_CNTRL pin
00B5   1507           00379         bsf     PORTC,SRVA_CNTRL    ;
                      00380         
                      00381         ;Servo B
00B6   1283 1303      00382         banksel PORTC               ;check if SRV_CNT is above SRVB_PW
00B8   02??           00383         subwf   SRVB_PW,W           ;
00B9   1C03           00384         btfss   STATUS,C            ; if above, clear SRV_CNTRL pin
00BA   1087           00385         bcf     PORTC,SRVB_CNTRL    ;
00BB   1803           00386         btfsc   STATUS,C            ; else, set SRV_CNTRL pin
00BC   1487           00387         bsf     PORTC,SRVB_CNTRL    ;
                      00388            
00BD   0008           00389         return                      ;return from the subroutine
                      00390         
                      00391         
                      00392 ;==========================================================================
                      00393 ;TMR1_OVFL routine code (software timers/counters)
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00394 ;==========================================================================
00BE                  00395 TMR1_OVFL:                          ;
00BE   1283 1303      00396         banksel PIR1                ;clear Timer 1 interrupt flag
00C0   100C           00397         bcf     PIR1,TMR1IF         ;
                      00398         
                      00399         ; Heartbeat control timing
00C1   03??           00400         decf    HB_TMR,F            ;increment heartbeat LED timer
00C2   1903           00401         btfsc   STATUS,Z            ;
00C3   2???           00402         call    TOGGLE_HB           ; if cleared, toggle the heartbeat
                      00403 
00C4                  00404 DEBOUNCING_LOOP:                    ;DEBOUNCING sequence loop
00C4   1C80           00405         btfss   FLAGS,DEBOUNCING    ;check if in DEBOUNCING state
00C5   2???           00406         goto    RUNNING_LOOP        ; if not, go to next part of Timer 1 ISR
00C6   03??           00407         decf    DEB_TMR,F           ;decrement debounce timer
00C7   1903           00408         btfsc   STATUS,Z            ; if debounce time is over
00C8   2???           00409         call    DEBOUNCE_END        ;   end the debouncing
                      00410         
00C9                  00411 RUNNING_LOOP:                       ;RUNNING sequence loop
00C9   1C00           00412         btfss   FLAGS,RUNNING       ;check if in RUNNING state
00CA   2???           00413         goto    END_TMR1_OVFL       ; if not, go to next part of Timer 1 ISR
00CB   03??           00414         decf    RUN_TMR,F           ;decrement RUN step timer
00CC   1903           00415         btfsc   STATUS,Z            ;
00CD   2???           00416         call    RUN_CNTRL           ; if cleared, call the RUN control routine
                      00417         
00CE                  00418 END_TMR1_OVFL:
00CE   0008           00419         return                      ;return from the subroutine
                      00420         
                      00421 ;==========================================================================
                      00422 ;TOGGLE_HB routine code
                      00423 ;==========================================================================
00CF                  00424 TOGGLE_HB:                      ;
00CF   1283 1303      00425         banksel PORTA           ;xor PORTA with the heartbeat LED bit value
00D1   3001           00426         movlw   HB_ON           ;
00D2   0685           00427         xorwf   PORTA,F         ;
00D3   300F           00428         movlw   HB_TIME         ;reset HB_TIME
00D4   00??           00429         movwf   HB_TMR          ;
00D5   0008           00430         return                  ;       
                      00431         
                      00432 ;==========================================================================
                      00433 ;RUN_CNTRL routine code
                      00434 ;==========================================================================
00D6                  00435 RUN_CNTRL:                          ;
00D6   0A??           00436         incf    RUN_INDX,F          ;begin next step in RUN sequence:
00D7   08??           00437         movf    RUN_INDX,W          ; - increment index
00D8   3C02           00438         sublw   NUM_STEPS           ;
00D9   1C03           00439         btfss   STATUS,C            ; - if a cycle is complete
00DA   2???           00440         goto    NEXT_CYCLE          ;      begin a new cycle
00DB   2???           00441         goto    RUN_STEP            ; - otherwise, run the next step
                      00442 
00DC                  00443 NEXT_CYCLE:
00DC   01??           00444         clrf    RUN_INDX            ;reset RUN step index
00DD   0B??           00445         decfsz  CYCL_CNT,W          ;decrement cycle counter
00DE   2???           00446         goto    RUN_STEP            ;  if not 0, run the first sequence step
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00DF   2???           00447         goto    END_CHASE           ;  if 0, stop the CHASE routine
                      00448     
00E0                  00449 RUN_STEP:                           ;   
00E0   2???           00450         call    RUN_STEP_SEQ        ;call nex RUN step from sequence
00E1   08??           00451         movf    RUN_INDX,W          ;get the corresponding step run time
00E2   2???           00452         call    RUN_STEP_TIME       ;put it into the step timer
00E3   00??           00453         movwf   RUN_TMR             ;
00E4   0008           00454         return                      ;
                      00455 
                      00456 ;==========================================================================
                      00457 ;TF_SET_FULL routine code
                      00458 ;==========================================================================
00E5                  00459 TF_SET_FULL:                        ;
00E5   1283 1303      00460     banksel     CCPR1L              ;set thrust fan duty cycle to FULL
00E7   3065           00461     movlw       TF_FULL             ;
00E8   0095           00462     movwf       CCPR1L              ;
00E9   0008           00463     return                          ;
                      00464 
                      00465 ;==========================================================================
                      00466 ;TF_SET_HALF routine code
                      00467 ;==========================================================================
00EA                  00468 TF_SET_HALF:                        ;
00EA   1283 1303      00469     banksel     CCPR1L              ;set thrust fan duty cycle to HALF
00EC   3032           00470     movlw       TF_HALF             ;
00ED   0095           00471     movwf       CCPR1L              ;
00EE   0008           00472     return                          ;
                      00473     
                      00474 ;==========================================================================
                      00475 ;TF_SET_OFF routine code
                      00476 ;==========================================================================
00EF                  00477 TF_SET_OFF:                         ;
00EF   1283 1303      00478     banksel     CCPR1L              ;set thrust fan duty cycle to OFF
00F1   3000           00479     movlw       TF_OFF              ;
00F2   0095           00480     movwf       CCPR1L              ;
00F3   0008           00481     return                          ;
                      00482         
                      00483 ;==========================================================================
                      00484 ;SRVA_ON routine code
                      00485 ;==========================================================================
00F4                  00486 SRVA_ON:                            ;
00F4   3008           00487         movlw   SRVA_ENG            ;set servo A pw to ENGAGED
00F5   00??           00488         movwf   SRVA_PW             ;
00F6   1500           00489         bsf     FLAGS,SRVA_ENGD     ;
00F7   0008           00490         return                      ;
                      00491         
                      00492 ;==========================================================================
                      00493 ;SRVA_OFF routine code
                      00494 ;==========================================================================
00F8                  00495 SRVA_OFF:                           ;
00F8   3006           00496         movlw   SRVA_DIS            ;set servo A pw to DISENGAGED
00F9   00??           00497         movwf   SRVA_PW             ;
00FA   1100           00498         bcf     FLAGS,SRVA_ENGD     ;
00FB   0008           00499         return                      ;
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00500 
                      00501 ;==========================================================================
                      00502 ;SRVB_ON routine code
                      00503 ;==========================================================================
00FC                  00504 SRVB_ON:                            ;
00FC   3008           00505         movlw   SRVB_ENG            ;set servo B pw to ENGAGED
00FD   00??           00506         movwf   SRVB_PW             ;
00FE   1580           00507         bsf     FLAGS,SRVB_ENGD     ;
00FF   0008           00508         return                      ;
                      00509         
                      00510 ;==========================================================================
                      00511 ;SRVB_OFF routine code
                      00512 ;==========================================================================
0100                  00513 SRVB_OFF:                           ;
0100   3006           00514         movlw   SRVB_DIS            ;set servo B pw to DISENGAGED
0101   00??           00515         movwf   SRVB_PW             ;
0102   1180           00516         bcf     FLAGS,SRVB_ENGD     ;
0103   0008           00517         return                      ;
                      00518         
                      00519 ;==========================================================================
                      00520 ;LIFT_ON routine code
                      00521 ;==========================================================================
0104                  00522 LIFT_ON:                            ;
0104   1283 1303      00523         banksel PORTC               ;turn ON the lift fan
0106   1707           00524         bsf     PORTC,LIFT_CNTRL    ;
0107   0008           00525         return                      ;
                      00526     
                      00527 ;==========================================================================
                      00528 ;LIFT_OFF routine code
                      00529 ;==========================================================================
0108                  00530 LIFT_OFF:                           ;
0108   1283 1303      00531         banksel PORTC               ;turn OFF the lift fan
010A   1307           00532         bcf     PORTC,LIFT_CNTRL    ;
010B   0008           00533         return                      ;
                      00534         
                      00535         
                      00536 ;==========================================================================
                      00537 ;**** RUN STEP BEHAVIOR FUNCTIONS ****
                      00538 ;==========================================================================     
010C                  00539 RUN_OFF:                            ;case: FERRET off
010C   2???           00540         call    TF_SET_OFF          ;thrust     -       OFF
010D   2???           00541         call    SRVA_OFF            ;servo A    -       OFF
010E   2???           00542         call    SRVB_OFF            ;servo B    -       OFF
010F   2???           00543         call    LIFT_OFF            ;lift       -       OFF
0110   0008           00544         return                      ;
                      00545         
0111                  00546 RUN_HRD_BRAKE:                      ;case: hard brake
0111   2???           00547         call    TF_SET_OFF          ;thrust     -       OFF
0112   2???           00548         call    SRVA_ON             ;servo A    -       ON
0113   2???           00549         call    SRVB_ON             ;servo B    -       ON
0114   2???           00550         call    LIFT_OFF            ;lift       -       OFF
0115   0008           00551         return                      ;
                      00552         
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0116                  00553 RUN_SFT_BRAKE:                      ;case: soft brake
0116   2???           00554         call    TF_SET_OFF          ;thrust     -       OFF
0117   2???           00555         call    SRVA_ON             ;servo A    -       ON
0118   2???           00556         call    SRVB_ON             ;servo B    -       ON
0119   2???           00557         call    LIFT_ON             ;lift       -       ON
011A   0008           00558         return                      ;
                      00559         
011B                  00560 RUN_DRIFT:                          ;case: idle drifting
011B   2???           00561         call    TF_SET_OFF          ;thrust     -       OFF
011C   2???           00562         call    SRVA_OFF            ;servo A    -       OFF
011D   2???           00563         call    SRVB_OFF            ;servo B    -       OFF
011E   2???           00564         call    LIFT_ON             ;lift       -       ON
011F   0008           00565         return                      ;
                      00566         
0120                  00567 RUN_FULL_FWD:                       ;case: full thrust forward
0120   2???           00568         call    TF_SET_FULL         ;thrust     -       FULL
0121   2???           00569         call    SRVA_OFF            ;servo A    -       OFF
0122   2???           00570         call    SRVB_OFF            ;servo B    -       OFF
0123   2???           00571         call    LIFT_ON             ;lift       -       ON
0124   0008           00572         return                      ;
                      00573         
0125                  00574 RUN_HALF_FWD:                       ;case: half thrust forward
0125   2???           00575         call    TF_SET_HALF         ;thrust     -       HALF
0126   2???           00576         call    SRVA_OFF            ;servo A    -       OFF
0127   2???           00577         call    SRVB_OFF            ;servo B    -       OFF
0128   2???           00578         call    LIFT_ON             ;lift       -       ON
0129   0008           00579         return                      ;
                      00580         
012A                  00581 RUN_FULL_LEFT:                      ;case: full thrust left turn
012A   2???           00582         call    TF_SET_FULL         ;thrust     -       FULL
012B   2???           00583         call    SRVA_ON             ;servo A    -       ON
012C   2???           00584         call    SRVB_OFF            ;servo B    -       OFF
012D   2???           00585         call    LIFT_ON             ;lift       -       ON
012E   0008           00586         return                      ;
                      00587         
012F                  00588 RUN_HALF_LEFT:                      ;case: half thrust left turn
012F   2???           00589         call    TF_SET_HALF         ;thrust     -       HALF
0130   2???           00590         call    SRVA_ON             ;servo A    -       ON
0131   2???           00591         call    SRVB_OFF            ;servo B    -       OFF
0132   2???           00592         call    LIFT_ON             ;lift       -       ON
0133   0008           00593         return                      ;
                      00594 
0134                  00595 RUN_BRAKE_LEFT:                     ;case: no thrust left turn
0134   2???           00596         call    TF_SET_OFF          ;thrust     -       OFF
0135   2???           00597         call    SRVA_ON             ;servo A    -       ON
0136   2???           00598         call    SRVB_OFF            ;servo B    -       OFF
0137   2???           00599         call    LIFT_ON             ;lift       -       ON
0138   0008           00600         return                      ;
                      00601         
0139                  00602 RUN_FULL_RIGHT:                     ;case: full thrust right turn
0139   2???           00603         call    TF_SET_FULL         ;thrust     -       FULL
013A   2???           00604         call    SRVA_OFF            ;servo A    -       OFF
013B   2???           00605         call    SRVB_ON             ;servo B    -       ON
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

013C   2???           00606         call    LIFT_ON             ;lift       -       ON
013D   0008           00607         return                      ;
                      00608         
013E                  00609 RUN_HALF_RIGHT:                     ;case: half thrust right turn
013E   2???           00610         call    TF_SET_HALF         ;thrust     -       HALF
013F   2???           00611         call    SRVA_OFF            ;servo A    -       OFF
0140   2???           00612         call    SRVB_ON             ;servo B    -       ON
0141   2???           00613         call    LIFT_ON             ;lift       -       ON
0142   0008           00614         return                      ;
                      00615         
0143                  00616 RUN_BRAKE_RIGHT:                    ;case: no thrust right turn
0143   2???           00617         call    TF_SET_OFF          ;thrust     -       OFF
0144   2???           00618         call    SRVA_OFF            ;servo A    -       OFF
0145   2???           00619         call    SRVB_ON             ;servo B    -       ON
0146   2???           00620         call    LIFT_ON             ;lift       -       ON
0147   0008           00621         return                      ;
                      00622         
                      00623 ;==========================================================================
                      00624 ;Utility functions
                      00625 ;==========================================================================        
                      00626     
                      00627         ;******** TEST TOGGLE METHOD *************
0148                  00628 TOGGLE_TEST_LED:                ;
0148   1283 1303      00629         banksel PORTC           ; Using pin RC1
014A   3002           00630         movlw   H'02'           ;
014B   0687           00631         xorwf   PORTC,F         ;
014C   0008           00632         return                  ;
                      00633         ;******** END TEST TOGGLE ****************
                      00634     
                      00635 ;==========================================================================
                      00636 ;END of code
                      00637 ;==========================================================================
3FC4                  00638     END                         ;
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE 14


SYMBOL TABLE
  LABEL                             VALUE 

ABDEN                             00000000
ABDOVF                            00000007
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000004
ADCS1                             00000005
ADCS2                             00000006
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
ANS0                              00000000
ANS1                              00000001
ANS10                             00000002
ANS11                             00000003
ANS2                              00000002
ANS3                              00000003
ANS4                              00000004
ANS5                              00000005
ANS6                              00000006
ANS7                              00000007
ANS8                              00000000
ANS9                              00000001
ANSEL                             0000011E
ANSELH                            0000011F
BAUDCTL                           0000009B
BF                                00000000
BRG0                              00000000
BRG1                              00000001
BRG10                             00000002
BRG11                             00000003
BRG12                             00000004
BRG13                             00000005
BRG14                             00000006
BRG15                             00000007
BRG16                             00000003
BRG2                              00000002
BRG3                              00000003
BRG4                              00000004
BRG5                              00000005
BRG6                              00000006
BRG7                              00000007
BRG8                              00000000
BRG9                              00000001
BRGH                              00000002
C                                 00000000
C1CH0                             00000000
C1CH1                             00000001
C1IE                              00000005
C1IF                              00000005
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE 15


SYMBOL TABLE
  LABEL                             VALUE 

C1OE                              00000005
C1ON                              00000007
C1OUT                             00000006
C1POL                             00000004
C1R                               00000002
C1SEN                             00000005
C1VREN                            00000007
C2CH0                             00000000
C2CH1                             00000001
C2IE                              00000006
C2IF                              00000006
C2OE                              00000005
C2ON                              00000007
C2OUT                             00000006
C2POL                             00000004
C2R                               00000002
C2REN                             00000004
C2SYNC                            00000000
C2VREN                            00000006
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCPR                              00000015
CCPR1H                            00000016
CCPR1L                            00000015
CHS0                              00000002
CHS1                              00000003
CHS2                              00000004
CHS3                              00000005
CKE                               00000006
CKP                               00000004
CM1CON0                           00000119
CM2CON0                           0000011A
CM2CON1                           0000011B
CREN                              00000004
CSRC                              00000007
CYCL_CNT                          00000073
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DEBOUNCE_END                      0000008F
DEBOUNCE_START                    00000082
DEBOUNCING                        1
DEBOUNCING_LOOP                   000000C4
DEB_TIME                          FIVE_S
DEB_TMR                           0000007A
D_A                               00000005
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE 16


SYMBOL TABLE
  LABEL                             VALUE 

D_NOT_A                           00000005
ECCPAS                            0000001D
ECCPAS0                           00000004
ECCPAS1                           00000005
ECCPAS2                           00000006
ECCPASE                           00000007
EEADR                             0000010D
EEADRH                            0000010F
EECON1                            0000018C
EECON2                            0000018D
EEDAT                             0000010C
EEDATA                            0000010C
EEDATH                            0000010E
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
EIGHT_S                           H'F4'
END_CHASE                         000000A3
END_TMR1_OVFL                     000000CE
F                                 00000001
FERR                              00000002
FIVE_S                            H'99'
FLAGS                             0000007B
FOUR_S                            H'7A'
FSR                               00000004
GIE                               00000007
GO                                00000001
GO_DONE                           00000001
GO_NOT_DONE                       00000001
HALF_S                            H'0F'
HB_LED                            RA0
HB_ON                             H'01'
HB_TIME                           HALF_S
HB_TMR                            00000079
HTS                               00000002
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
INDF                              00000000
INIT_VARS                         0000005C
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
IOC                               00000096
IOC0                              00000000
IOC1                              00000001
IOC2                              00000002
IOC3                              00000003
IOC4                              00000004
IOC5                              00000005
IOCA                              00000096
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE 17


SYMBOL TABLE
  LABEL                             VALUE 

IOCA0                             00000000
IOCA1                             00000001
IOCA2                             00000002
IOCA3                             00000003
IOCA4                             00000004
IOCA5                             00000005
IOCB                              00000116
IOCB4                             00000004
IOCB5                             00000005
IOCB6                             00000006
IOCB7                             00000007
IOC_RESP                          0000007E
IRCF0                             00000004
IRCF1                             00000005
IRCF2                             00000006
IRP                               00000007
ISR_IOCA                          00000065
ISR_POP                           00000077
ISR_PUSH                          00000060
ISR_T0                            00000069
ISR_T1                            0000006F
LIFT_CNTRL                        RC6
LIFT_OFF                          00000108
LIFT_ON                           00000104
LTS                               00000001
MAIN_LOOP                         0000005A
MAIN_SETUP                        00000000
MC1OUT                            00000007
MC2OUT                            00000006
MSK                               00000093
MSK0                              00000000
MSK1                              00000001
MSK2                              00000002
MSK3                              00000003
MSK4                              00000004
MSK5                              00000005
MSK6                              00000006
MSK7                              00000007
NEXT_CYCLE                        000000DC
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BOR                           00000000
NOT_DONE                          00000001
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RABPU                         00000007
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_W                             00000002
NOT_WRITE                         00000002
NUM_CYCLS                         H'FF'
NUM_STEPS                         H'02'
OERR                              00000001
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE 18


SYMBOL TABLE
  LABEL                             VALUE 

ONE_S                             H'1E'
OPTION_REG                        00000081
OSCCON                            0000008F
OSCTUNE                           00000090
OSFIE                             00000007
OSFIF                             00000007
OSTS                              00000003
P                                 00000004
P1M0                              00000006
P1M1                              00000007
PCL                               00000002
PCLATH                            0000000A
PCLATH_TEMP                       00000072
PCON                              0000008E
PDC0                              00000000
PDC1                              00000001
PDC2                              00000002
PDC3                              00000003
PDC4                              00000004
PDC5                              00000005
PDC6                              00000006
PEIE                              00000006
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PR2                               00000092
PRSEN                             00000007
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSSAC0                            00000002
PSSAC1                            00000003
PSSBD0                            00000000
PSSBD1                            00000001
PSTRCON                           0000019D
PULSR                             00000002
PULSS                             00000003
PWM1CON                           0000001C
R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RABIE                             00000003
RABIF                             00000000
RB4                               00000004
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE 19


SYMBOL TABLE
  LABEL                             VALUE 

RB5                               00000005
RB6                               00000006
RB7                               00000007
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RCIDL                             00000006
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
READ_WRITE                        00000002
RP0                               00000005
RP1                               00000006
RUNNING                           0
RUNNING_LOOP                      000000C9
RUN_BRAKE_LEFT                    00000134
RUN_BRAKE_RIGHT                   00000143
RUN_BTN                           RA2
RUN_CNTRL                         000000D6
RUN_DRIFT                         0000011B
RUN_FULL_FWD                      00000120
RUN_FULL_LEFT                     0000012A
RUN_FULL_RIGHT                    00000139
RUN_HALF_FWD                      00000125
RUN_HALF_LEFT                     0000012F
RUN_HALF_RIGHT                    0000013E
RUN_HRD_BRAKE                     00000111
RUN_IND                           RA1
RUN_INDX                          0000007C
RUN_OFF                           0000010C
RUN_SFT_BRAKE                     00000116
RUN_STEP                          000000E0
RUN_STEP_SEQ                      00000005
RUN_STEP_TIME                     00000009
RUN_TMR                           00000078
RX9                               00000006
RX9D                              00000000
R_NOT_W                           00000002
R_W                               00000002
S                                 00000003
SBOREN                            00000004
SCKP                              00000004
SCS                               00000000
SENB                              00000003
SENDB                             00000003
SEVEN_S                           H'D6'
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE 20


SYMBOL TABLE
  LABEL                             VALUE 

SIX_S                             H'B7'
SMP                               00000007
SPBRG                             00000099
SPBRGH                            0000009A
SPEN                              00000007
SR0                               00000006
SR1                               00000007
SRCON                             0000019E
SREN                              00000005
SRVA_CNTRL                        RC2
SRVA_DIS                          H'06'
SRVA_ENG                          H'08'
SRVA_ENGD                         2
SRVA_OFF                          000000F8
SRVA_ON                           000000F4
SRVA_PW                           00000075
SRVB_CNTRL                        RC1
SRVB_DIS                          H'06'
SRVB_ENG                          H'08'
SRVB_ENGD                         3
SRVB_OFF                          00000100
SRVB_ON                           000000FC
SRVB_PW                           00000076
SRV_CNT                           00000074
SRV_TMR                           00000077
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPMSK                            00000093
SSPOV                             00000006
SSPSTAT                           00000094
START_CHASE                       00000097
STATUS                            00000003
STATUS_TEMP                       00000071
STRA                              00000000
STRB                              00000001
STRC                              00000002
STRD                              00000003
STRSYNC                           00000004
SWDTEN                            00000000
SYNC                              00000004
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE 21


SYMBOL TABLE
  LABEL                             VALUE 

T1CKPS1                           00000005
T1CON                             00000010
T1GINV                            00000007
T1GSS                             00000001
T1IE                              00000000
T1IF                              00000000
T1OSCEN                           00000003
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
T2IE                              00000001
T2IF                              00000001
TF_DIR                            RC4
TF_FULL                           TF_PERIOD
TF_HALF                           H'32'
TF_OFF                            H'00'
TF_PERIOD                         H'65'
TF_PWM                            RC5
TF_SET_FULL                       000000E5
TF_SET_HALF                       000000EA
TF_SET_OFF                        000000EF
THREE_S                           H'5C'
TMR0                              00000001
TMR0_OVFL                         000000A8
TMR1                              0000000E
TMR1CS                            00000001
TMR1GE                            00000006
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR1_OVFL                         000000BE
TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOGGLE_HB                         000000CF
TOGGLE_TEST_LED                   00000148
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISB                             00000086
TRISB4                            00000004
TRISB5                            00000005
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE 22


SYMBOL TABLE
  LABEL                             VALUE 

TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000087
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRMT                              00000001
TUN0                              00000000
TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
TWENTY_MS                         H'4E'
TWO_S                             H'3D'
TX9                               00000006
TX9D                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
UA                                00000001
ULPWUE                            00000005
VCFG                              00000006
VP6EN                             00000004
VR0                               00000000
VR1                               00000001
VR2                               00000002
VR3                               00000003
VRCON                             00000118
VRR                               00000005
W                                 00000000
WAIT_4_CLOCK                      00000004
WAIT_4_CYCLE                      00000052
WCOL                              00000007
WDTCON                            00000097
WDTPS0                            00000001
WDTPS1                            00000002
WDTPS2                            00000003
WDTPS3                            00000004
WPU                               00000095
WPU0                              00000000
WPU1                              00000001
WPU2                              00000002
WPU4                              00000004
WPU5                              00000005
WPUA                              00000095
WPUA0                             00000000
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE 23


SYMBOL TABLE
  LABEL                             VALUE 

WPUA1                             00000001
WPUA2                             00000002
WPUA4                             00000004
WPUA5                             00000005
WPUB                              00000115
WPUB4                             00000004
WPUB5                             00000005
WPUB6                             00000006
WPUB7                             00000007
WR                                00000001
WREN                              00000002
WRERR                             00000003
WUE                               00000001
W_TEMP                            00000070
Z                                 00000002
_BOD_NSLEEP                       00003EFF
_BOD_OFF                          00003CFF
_BOD_ON                           00003FFF
_BOD_SBODEN                       00003DFF
_BOREN_NSLEEP                     00003EFF
_BOREN_OFF                        00003CFF
_BOREN_ON                         00003FFF
_BOREN_SBODEN                     00003DFF
_BOR_NSLEEP                       00003EFF
_BOR_OFF                          00003CFF
_BOR_ON                           00003FFF
_BOR_SBODEN                       00003DFF
_CONFIG                           00002007
_CPD_OFF                          00003FFF
_CPD_ON                           00003F7F
_CP_OFF                           00003FFF
_CP_ON                            00003FBF
_DEVID1                           00002006
_EC_OSC                           00003FFB
_EXTRC                            00003FFF
_EXTRCIO                          00003FFE
_EXTRC_OSC_CLKOUT                 00003FFF
_EXTRC_OSC_NOCLKOUT               00003FFE
_FCMEN_OFF                        000037FF
_FCMEN_ON                         00003FFF
_FOSC_EC                          00003FFB
_FOSC_EXTRCCLK                    00003FFF
_FOSC_EXTRCIO                     00003FFE
_FOSC_HS                          00003FFA
_FOSC_INTRCCLK                    00003FFD
_FOSC_INTRCIO                     00003FFC
_FOSC_LP                          00003FF8
_FOSC_XT                          00003FF9
_HS_OSC                           00003FFA
_IDLOC0                           00002000
_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
MPASM 5.68                FERRET_CONTROL.ASM   5-31-2017  17:31:35         PAGE 24


SYMBOL TABLE
  LABEL                             VALUE 

_IESO_OFF                         00003BFF
_IESO_ON                          00003FFF
_INTOSC                           00003FFD
_INTOSCIO                         00003FFC
_INTRC_OSC_CLKOUT                 00003FFD
_INTRC_OSC_NOCLKOUT               00003FFC
_LP_OSC                           00003FF8
_MCLRE_OFF                        00003FDF
_MCLRE_ON                         00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FEF
_WDTE_OFF                         00003FF7
_WDTE_ON                          00003FFF
_WDT_OFF                          00003FF7
_WDT_ON                           00003FFF
_XT_OSC                           00003FF9
__16F690                          00000001

Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :    21 reported,     0 suppressed

